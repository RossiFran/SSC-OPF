# Training Data Generation
This subfolder contains the code for the data generation step, following the methodology presented in [1].

## Data and Usage
The main scripts implement the methodology steps by invoking the other scripts located in the folder. The methodology steps are illustrated in the figure. Following that, details on each step are provided, along with the corresponding scripts where they are implemented.

<img src="https://github.com/user-attachments/assets/a51cf3b0-ced3-425f-a6c3-8bc0093696e6" width="500">

1. Define the operable space to be explored. Initialize the set of excluded regions as empty. (in *sampling_initial_exploration.m*)
2. Initial space exploration (in *sampling_initial_exploration.m*):
  * Divide the space into regions
  * Sample operating points in each region applying Latin Hypercube Sampling (LHS)
3. Small-signal stability assessment.
  For each sampled operating point:
  * Calculate the Power Flow (PF) (in *run_PF.m*)
  * Obtain the equilibrium point of the system (in *Initial_values_PF.m*)
  * Calculate the state-space linear model around the equilibrium point (in *Eqs_SS_model.m*)
  * Calculate the eigenvalues of the system state matrix (in *Small_signal_analysis.m*)
  * Classify the point as stable or unstable (in *main.m*)
  * Store the results in the data base (DB) (in *main.m*): store the solution of the PF, i.e. the demand variables (P: loads power), the control variables (U: generators power and converter control tuning parameters), and the state variables (X: magnitude and phase of buses voltage), and the real and imaginary parts of the eigenvalues (λs).
4. Stability margin detection (in *main.m*): in each region calculate the Entropy among the points belonging to the region, considering the two classes stable/unstable. If the region's Entropy is non-null, then the stability margin crosses that region. Otherwise, add the region to the set of excluded regions, to not further generate samples in it. 
5. In each region not included in the set of excluded regions (i.e. crossed by the stability margin):
 * Sample other points (in *sampling_second_iteration.m* or *sampling_successive_iterations.m*)
 * Perform the small-signal stability assessment as in point 3
 * Update the points belonging to the region
 * Recalculate the region's Entropy
 * If the region's Entropy did not decreased compared to the previous iteration, repeat the previous steps. Otherwise, add the region to the set of excluded regions, to not further generate samples in it. 

Save the results in Excel files, in the Data Set folder:
* training_data_LHS*nlhs*_*nlhs2*_nreg*nreg*.xlsx: collects values of the demand variables (P: loads power), the control variables (U: generators power), and the state variables (X: magnitude and phase of buses voltage) as calculated by PF for each sampled operating point.
* real_parts_eigenvalues_LHS*nlhs*_*nlhs2*_nreg*nreg*.xlsx: collects the real parts of the eigenvalues calculated for each sampled operating point.
* imag_parts_eigenvalues_LHS*nlhs*_*nlhs2*_nreg*nreg*.xlsx: collects the imaginary parts of the eigenvalues calculated for each sampled operating point.
  
*nlhs*: number of samples generated by Latin Hypercube Sampling (in each region), in the initial space exploration.

*nlhs2*: number of samples generated by Latin Hypercube Sampling (in each region), at second and successive iterations.

*nreg*: number of regions in which the operable space is divided. 

## References
Rossi, F., Araujo, E. P., Mañe, M. C., & Bellmunt, O. G. (2022, October). Data generation methodology for machine learning-based power system stability studies. In 2022 IEEE PES Innovative Smart Grid Technologies Conference Europe (ISGT-Europe) (pp. 1-5). IEEE.
